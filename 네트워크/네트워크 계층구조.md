1. [통신 프로토콜과 계층 구조](#통신-프로토콜과-계층-구조)  
2. [네트워크 응용 계층 원리](#네트워크-응용-계층-원리)  
3. [트랜스포트 계층 서비스](#트랜스포트-계층-서비스)  
4. [물리 계층](#물리-계층)
5. [데이터 링크 계층](#데이터-링크-계층)

# 통신 프로토콜과 계층 구조
* 통신 프로토콜 정의
    * 통신 장치들간에 교환될 메시지의 형식 정의
    * 메시지 교환 순서 정의
    * 메시지를 교환할 때 수행해야 할 행위를 정의
    * 프로토콜은 계층 구조를 가진다
        * 상위 프로토콜은 하위 프로토콜의 사용자이다

* 계층 구조의 장점
    * 새로운 프로토콜 정의 용이
    * 특정 통신 기능 또는 서비스 수정 용이
    * 전체 시스템 이해 용이
* 계층 구조의 단점
    * 최적 시스템 구현의 어려움(프로토콜 단위 사용, 계층간 서비스 인터페이스 구현)

* 프로토콜
    * 특정 통신 서비스를 위한 정보 교환 규칙 정의
    * 유사한 통신 서비스를 위해 유사한 프로토콜 다수 정의 가능
    * 물리 매체 프로토콜 : UTP, 광케이블, 무선 채널
    * 인터넷 응용 프로토콜 : HTTP(웹 서비스), SMTP(이메일 서비스)
* 계층
    * 유사한 프로토콜들의 집합
    * 1개의 계층에 다수의 프로토콜 존재 가능

# 계층 구조 모델
* TCP/IP 계층 구조
    * 인터넷 프로토콜 구조
    * 5 계층 구조
* OSI 구조
    * ISO에서 정의
    * 7계층 구조
    * 실제 사용되지 않고 참조 모델로 활용

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F99BDD3335A2CEAB81D3BA5)


## 응용 계층
* 인터넷 최종 사용자 서비스를 위한 정보 교환 규칙 정의
    * 교환할 정보에 대한 규칙
* 사용자 서비스 종류에 따라 서로 다른 응용 프로토콜 정의
* 웹 서비스 : HTTP
* 이메일 서비스 : SMTP
* 파일 전송 서비스 : FTP
* 도메인 네임 서비스 : DNS

## 트랜스포트 계층
* 응용 계층 프로토콜 간에 메시지를 작은 전송단위(segment)로 나누고 전송하는 규칙 정의
    * 정보 교환에 관한 규칙
    * 양쪽이 같은 프로토콜이어야 함
* 응용 프로토콜 지정(End-point, port 번호)
    * 응용프로토콜 지정
        * 어디로 가는지 지정
* 오류 제어(Error control)
    * 오류 발생시 복구하는 절차
* 흐름 제어(Flow control)
    * 수신자가 수신할 수 있는 양만 보냄
* 혼잡 제어(Congestion control)
    * 트래픽이 몰려서 큐에 공간이 없는 등의 상황제어 
* TCP(Transmission Control Protocol), UDP(User Datagram Protocol)

## 네트워크 계층
* 네트워크 상에서 최적 경로를 찾는다
* 출발지 트랜스포트 프로토콜의 전송단위(segment)를 네트워크 전달 단위인 데이터그램(Datagram)으로 변환
    * segment에 목적지 출발지 주소 정보를 더해서 datagram을 만든다
* 목적지 트랜스포트 프로토콜까지 데이터그램을 **최적의 경로**를 통해 교환하고 전달
* 데이터그램 전달 프로토콜 : IP
* 최적 경로 찾기 프로토콜 : Routing Protocol

## 링크 계층
* 네트워크 경로를 구성하는 각 링크상에서, 네트워크 전송단위(데이터그램)을 프레임으로 변환하고, 링크의 끝까지 전송하는 규칙 정의
* 링크의 유형에 따라 다양한 링크 프로토콜 정의
* 유선 LAN : Ethernet 
* 무선 LAN : WIFI

## 물리 계층
* 디지털 비트와 물리적인 신호의 변환과 물리 매체 접속 규격 정의
* 물리 매체의 유형에 따라 다양한 물리 프로토콜 정의
* Ethernet 링크를 위해 UTP, 광케이블 물리 프로토콜 정의
* WIFI 채널의 디지털 비트와 물리 신호의 변환 방법에 따라 다양한 물리 프로토콜 정의

## OSI 프레젠테이션 계층
* 응용 프로토콜이 교환하는 정보의 의미를 동일하게 해석하도록 표현하는 규칙 정의
* 데이터 표현, 압축 방식, 암호 방식 등
* TCP/IP 구조에서는 필요한 경우 응용 프로토콜에서 정의

## OSI 세션 계층
* 점검 점 입력으로 교환되는 정보를 구분하고, 교환정보를 상호 동기화하며, 복구할 수 있는 규칙 정의
* TCP/IP 구조에서는 필요한 경우 응용 프로토콜에서 정의

# 갭술화
* 프로토콜 교환 정보
    * 상위 프로토콜에서 하위 프로토콜로 정보 보내달라고 의뢰, 하위 프로토콜에서는 받은 데이터 정보에 제어 정보까지 붙여서 다시 하위 프로토콜로 의뢰하거나 혹은 상대 사용자에게 전송
    * 데이터 정보(data information) : 사용자가 통신 상대방 사용자에게로 전송하도록 의뢰한 정보
    * 제어 정보(Control information) : 프로토콜의 규칙을 수행하기 위해 상대방 프로토콜에게 제공하는 정보
* 계층별 프로토콜 교환정보 이름
    * application 계층 : message, M
    * transport 계층 : segment, M + Ht
        * Ht : port 번호
    * network 계층 : datagram, (M + Ht) + Hn
        * Hn : IP 주소
    * link 계층 : frame, ((M + Ht + Hn) + Hl
* L2 스위치의 경우 physical, link 계층까지만 처리하면 된다
    * MAC주소만 알아야 하니 link 계층 프로토콜까지 처리
* 라우터의 경우 physical, link, network 계층까지만 처리하면 된다
    * IP주소를 알아야 하니 network 계층 프로토콜까지 처리


# 네트워크 응용계층 원리
## 네트워크와 네트워크 응용
네트워크 응용 서비스 
* 네트워크 통신 서비스를 사용/응용 하여 최종 사용자에게 제공되는 서비스
* 네트워크에 연결된 2개 이상의 호스트에서 동작하는 프로그램으로 구현

네트워크 구성
* 호스트 : 응용 정보(URL, HTML 페이지)를 교환하고 해선하고 처리
* 스위치(라우터) : 네트워크 장치를 연결하고 패킷을 교환

패킷
* 응용 정보를 효율적인 교환을 위해 작은 크기로 나눈 정보단위
* 호스트에서 재조립되어 응용 계층에서 처리


의미있는 정보를 주고 받는 **호스트**들에서 동작하는 네트워크 응용

스위치는 응용 정보 처리에 관여하지 않는다. 단지 정보를 패킷으로 나눠 전달하는 역할만 한다.


## 네트워크 응용 구조
분산 네트워크 응용 프로그램이 작동하는 방식

네트워크 응용 구조 유형
* 클라이언트-서버 구조
* P2P 구조

### 클라이언트-서버 구조
동작방식
* 항상 클라이언트 응용 프로그램은 요청한다
* 서버의 응용 프로그램은 응답을 수행한다

클라이언트(Client)
* 서버에게 응용 서비스 요청(클라이언트간 통신 No)
* 필요할 때만 작동
* 동적(임시) IP 주소 사용 가능
    * 필요할때마다 사용하면 되니 동적이다

서버
* 다수의 클라이언트의 서비스 요청에 응답
* 항상 작동(Always-on)
* 고정(또는 그에 준하는) IP 주소 사용
* 확장성(scalability) 문제


### P2P 구조
동작방식
* 임의의 호스트간에 직접 통신한다
* 각 호스트는 클라이언트 역할과 서버 역할을 동시에 수행한다
* 호스트간의 관계가 대등하다(peer-to-peer)

장점
* 서버 의존성이 없음
* 구축 및 관리 비용이 낮음
* 자가 확장성(Self-scalability)

문제점
* 보안 취약성(Security)
* 낮은 신뢰성(Reliability)
* 낮은 성능(Performance)


## 네트워크 응용 프로세스와 응용 프로토콜
네트워크 응용 프로세스 
* 호스트에서 네트워크를 통해 응용 메시지를 교환하며 작동하는 프로그램

응용 프로토콜
* 네트워크 응용 프로그램 간의 응용 메시지 교환
* 응용 프로세스의 일부

클라이언트 프로세스
* 통신을 개시하는 응용 프로세스

서버 프로세스
* 클라이언트의 통신 요청을 기다리는 응용 프로세스



## 네트워크 응용 프로세스와 트랜스포트 프로토콜
소켓(socket)
* 응용 프로세스가 네트워크로 메시지를 송신하고 수신하는 통로 자료구조
* 트랜스포트 계층 상에서 구현
* 어플리케이션 프로세스가 사용하는 소켓 자료구조의 주소를 Port번호라 한다

소켓 API
* 소켓 자료구조를 사용하여 통신 서비스를 제공하는 프로그램 인터페이스
* API를 사용하여 응용 프로그램 구현

응용 프로세스 주소
* Socket 주소 : IP 주소 + Port 번호
    * 하나의 Host에 여러 어플리케이션 프로세스가 동작할 수 있다
    * 그러므로 IP주소만 가지고는 유니크한 어플리케이션 주소를 가질 수 없다
    * 그러므로 IP주소와 Port 번호를 합하여 어플리케시션의 주소를 가리키는 실제 주소가 되고 이 주소로 통신하게 된다

트랜스포트 프로토콜
* TCP
    * 응용 프로세스간 신뢰 전송
    * 저성능 전송
* UDP
    * 응용 프로세스간 비신뢰 전송
    * 고성능 전송

# 트랜스포트 계층 서비스
## 네트워크 계층 서비스
호스트(Host)간의 통신
* 인터넷 호스트간의 통신에는 패킷을 전달한다
    * 네트워크 계층에서의 데이터 통신의 단위
* 호스트의 인터넷 통신장치로 NIC(Network Interface Card)를 사용한다
    * PC 또는 스마트폰에 부착되어 네트워크 계층 이하의 통신 서비스를 담당하는 장치
    * 호스트의 NIC가 목적지의 NIC로 패킷(데이터그램)을 전달한다

최선형(Best-effort) 서비스
* 자원이 허락하는 범위내에서 최적의 통신 서비스 제공
* 자원이 부족한 경우 지연시간 발생, 패킷 훼손/손실 발생 가능 : 비 신뢰 서비스
    * 버퍼 오버플로 등으로 패킷 손상 가능

비연결성(Connectionless) 서비스
* 패킷 전달 경로가 다를 수 있음
* 패킷 도착 순서가 바뀔 수 있음

IP(Internet Protocol)
* IP 주소 기반의 패킷(데이터그램) 전달
* IP 주소 : 인터넷에 연결된 NIC(호스트) 구분

## 트랜스포트 계층 
### 응용 프로세스 간의 통신
네트워크 계층의 통신은 NIC에서 목적지의 NIC에 데이터그램을 전달하는 것이다. 이런 네트워크 계층의 프로토콜 이름이 IP 이다.

한 호스트 내에서는 프로세스가 여러 개 존재할 수 있다. 트랜스포트 계층은 IP가 제공하는 통신 서비스를 이용해서 호스트의 한 프로세스와 목적지에 있는 특정한 프로세스까지의 통신 서비스를 담당한다. 네트워크 계층의 IP를 사용하기 때문에 포함한다고 볼 수 있다.

어플리케이션의 프로세스와 프로세스 간의 통신서비스를 제공하는 것을 담당하는 것이 트랜스포트 계층이다.

## 트랜스포트 계층의 5가지 서비스
트랜스포트 계층은 5가지 서비스를 제공한다. 

### 세그멘테이션/리어셈블리(Segmentation/Reassembly)
응용 프로세스가 전송 요구하는 메시지를 트랜스포트 계층에서 네트워크 계층이 교환가능한 크기의 단위로 나누어(segmentation) 네트워크 계층에 전달

네트워크 계층을 통해 수신되는 세그먼트들을 메시지로 재조립하여 응용 프로세스에게 전달

### 다중화(multiplexing)/역다중화(demultiplexing)
다수의 응용 프로세스가 전송 요구하는 메시지를 구분가능한 정보를 추가한 세그먼트로 만들어 네트워크 계층에 전달 : 포트 번호 기반

네트워크 계층을 통해 수신되는 세그먼트의 포트번호를 사용하여 메시지를 전달할 응용 프로세스 선택

### 무결성
* 수신 세그먼트 비트의 손상 여부 확인
* Checksum(검사합) 기술 적용

### 신뢰 전송(Reliable Transfer)
* 오류 복구 : 손상 또는 손실 세그먼트 복구
* 흐름 제어 : 수신 버퍼 오버플로어 방지
    * 수신자가 받을 수 있는 양만큼만 세그먼트를 조절해서 전송

### 혼합 제어(Congesion Control)
* 전송량 조절을 통해 네트워크 혼잡 상황 회피 및 해소
* 트랜스포트 계층에서 네트워크 계층으로 전달하는 트래픽의 양을 조절해 네트워크의 혼잡 상황을 회피 및 해소하는 것을 담당하는 것을 트랜스포트 계층의 혼잡 제어라 한다

## 트랜스포트 계층 프로토콜
응용 계층에서 항상 트랜스포트 계층의 5가지 서비스를 전부 사용하는 것은 아니다. 

그래서 사용하는 서비스에 따라 TCP, UDP 이렇게 2가지 프로토콜을 정의했다.

![](https://postfiles.pstatic.net/MjAyMTEwMDFfMTYy/MDAxNjMzMDE1MDE3ODEy._82MnrcdZ1FJ8rGMwi6X5_qlZt-zhjt947cS6fmDEggg.sYAJk9TBg86A7bSxT7N3UuKfXZHRt0SI6JbXhJ54JVAg.PNG.2008qwe/image.png?type=w773)

## 트랜스포트 다중화/역다중화
네트워크계층은 인터넷 사이의 호스트와 호스트간의 데이터를 전달하는 것을 담당한다. 여기서 데이터 전달을 담당하는 장비를 NIC라고 한다. 한 호스트의 NIC에서 다른 호스트의 NIC까지 패킷(데이터그램)을 전달하는 서비스를 담당하는 것이 네트워크 계층이다.

한 서버에서 여러 프로세스가 동작할 수 있기 때문에 네트워크 계층의 IP 주소는 호스트의 NIC를 구분하기 위한 주소이기 때문에, IP주소를  가지고는 NIC가 장착된 호스트에 여러 프로세스가 있을 때 그 프로세스를 구분하는 것은 불가능하다.

그래서 port번호를 통해 프로세스를 구분하게 된다. 이렇게 port번호를 통해 프로세스를 구분할 수 있도록 해주는 트랜스포트 계층의 서비스를 다중화 서비스라 한다. 

이렇게 IP 주소와 port 번호가 있다면, 인터넷에 연결된 모든 프로세스를 구분할 수 있다.

## 다중화/역다중화 개념
트랜스포트 계층에서 세그먼트 하나를 만들고 이 세그먼트에서 다중화 역다중화에 필요한 정보(출발지 포트번호, 도착지 포트번호)를 붙인다.

트랜스포트 계층에서 메시지를 세그먼트로 나눈 다음 그 앞에 출발지 도착지 포트번호를 붙여 네트워크 계층으로 내려보냄.

이렇게 내려간 세그먼트는 IP datagram의 data 부분에 들어간다. 이 data가 IP 데이터그램의 세그먼트.

이 세그먼트를 네트워크 계층에서 처리하기 위해서 필요한 정보들을(IP 주소 등) 앞에다 붙여준다. 이런 작업을 캡슐화(Encapsulation)이라 한다.

## 소켓(socket)
트랜스포트 계층이 제공하는 응용 프로세스 통신 통로 자료구조

응용 프로세스 주소 : 소켓 주소(IP 주소 + 포트번호)

## 다중화 유형
* 연결형 다중화 
    * 통신 소켓간에 1 : 1 논리적 연결 설정
    * 통신이 끝날때까지 소켓간 열결되어 있고, 연결된 소켓끼리만 데이터 전송 가능
* 비연결형 다중화
    * 통신 소켓간에 1 : 1 논리적 연결 미설정
    * 연결되어있지 않아 여럿이 통신 가능

## 비연결형 다중화 : UDP
소켓 식별 : IP 주소 + port 번호

직접 연결된 것이 아니라 소켓 주소를 보고 누가 보냈는지 식별한 후 처리. 1 대 N 통신이 가능하다.


## 연결형 다중화 : TCP
소켓 식별 : 출발지 IP 주소 + 출발지 Port 번호 + 목적지 IP 주소 + 목적지 Port 번호

통신을 하기 전 소켓과 소켓간 1 대 1 관계 설정한다. 





# 네트워크 계층
데이터 링크 계층은 통신하고자 하는 하드웨어의 MAC 주소를 알아야 한다. 하지만 이를 위해서는 통신하려는 개체가 물리 계층으로 직접 연결되어 있어야 하는데, 네트워크를 모두 직접 연결하는 것은 불가능 하다. 

그래서 네트워크 계층에서 IP 주소를 사용하여 통신하게 된다.

IP 주소는 일반적으로 인터넷을 하기 위해 컴퓨터마다 설정하는 주소라고 생각하기 쉽지만, 더 중요한 의미는 각 랜의 주소, 즉 세계에 펼쳐진 네트워크의 주소이다..?

## 네트워크 계층 프로토콜




# 데이터 링크 계층
네트워크는 OSI 7계층 모두가 있어야만 데이터 통신이 가능한 것은 아니다. 물리 계층과 데이터 링크 계층만 존재해도 네트워킹이 가능하다. 예를 들어 컴퓨터 두 대를 크로스 케이블로 직접 연결하여 데이터를 전송하는 것을 데이터 링크 계층만을 이용한 네트워킹이라 할 수 있다.

데이터 링크 계층은, 랜 카드나 네트워크 장비의 하드웨어 주소만으로 통신하는 계층이라고 생각하면 된다. 랜 카드나 네트워크 장비의 하드웨어 주로를 MAC주소라고 한다. MAC 주소는 네트워크 카드마다 붙는 고유한 이름이다. 

## MAC 주소
MAC 주소는 총 12개의 16진수로 구성된다. 앞쪽 6개는 네트워크 카드를 만든 회사를 나타낸다. 

## 데이터 링크 계층 프로토콜
데이터 링크 계층의 대표적인 프로토콜은 이더넷 프로토콜이다. 

## 데이터 링크 계층 관련 장비
브리지
* 랜과 랜을 연결하는 초기의 네트워크 장치

스위치

## 스위칭
스위치는 데이터 링크 계층의 통신을 담당하는 대표적인 장비로, 스위치가 동작하는 방식을 스위칭이라 한다. 


# 물리 계층
1계층인 물리 계층은 시스템 간의 연결선이다. 흔히 랜 케이블을 말하지만, 전화선이 될 수 있고, 동축 케이블, 광케이블이 될 수 있다. 

