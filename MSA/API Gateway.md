# API Gateway

- API 서버 앞단에서 모든 API 서버들의 엔드포인트를 단일화하여 묶어주고 API에 대한 인증, 인가, 라우팅, 프로토콜이나 포맷 변환 등 여러 기능을 담당
- ESB 에서 시작되었다

## API 게이트웨이 주요 기능

### 인증/인가에 관련된 기능

- 인증은 토큰 기반 방식을 사용한다
- 절차
    - 클라이언트가 인증 정보 API Gateway 에 전송
    - API Gateway에서 인증 서버로 인증 요청
    - 보통 토큰 사용
- 인가
    - 두 가지 방법이 있다
    - 토큰에 권한을 부여하는 방식
    - 역할을 부여하는 방식

## API 라우팅

- 같은 API라도 사용하는 서비스나 클라이언트에 따라 다른 엔드포인트를 이용하여 서비스를 제공하거나,
- 데이터 센터가 여러 개 일 때, 데이터 센터간의 라우팅들을 지원하는 기능
- 로드 밸런싱 기능 제공
- 메시지 또는 헤더기반 라우팅
- 등등

## aggregation

- 여러 개의 API를 묶어 하나의 API 로 만드는 작업
- 하나의 작업에 여러 API 호출이 필요한 경우 하나로 묶을 수 있다

## Mediator

- 프로토콜 변환 등도 해준다
    - 다른 통신 프로토콜을 사용하는 경우 API Gateway에서 프로토콜을 변환해 서비스를 호출할 수 있도록 할 수 있다
- 메시지 포맷 변환
    - 클라이언트로부터 들어온 요청을 API 서버에 맞게 데이터를 변환하거나, API 서버에서 응답하는 데이터를 클라이언트가 원하는 데이터로 변경
    

### 로깅

- 호출들이 API Gateway를 거쳐가는 만큼 모든 로그를 중간에서 수집하기도 한다